"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CommonSdkInfo=void 0;const hvigor_base_1=require("@ohos/hvigor-base"),sdkmanager_common_1=require("@ohos/sdkmanager-common"),inject_const_js_1=require("../../const/inject-const.js"),sdk_ets_component_js_1=require("../impl/sdk-ets-component.js"),sdk_js_component_js_1=require("../impl/sdk-js-component.js"),sdk_native_component_js_1=require("../impl/sdk-native-component.js"),sdk_toolchains_component_js_1=require("../impl/sdk-toolchains-component.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),sdk_util_js_1=require("../lib/sdk-util.js");class CommonSdkInfo{constructor(t,o){this.LOGGER=ohos_logger_js_1.OhosLogger.getLogger("Ohos sdk"),this.localLibComponents=new Map,this.sdkVersion=t,this.sdkDir=o}getToolchainsComponentVersion(){var t;return null===(t=this.toolchainsComponent)||void 0===t?void 0:t.getComponentVersion().getVersion()}getModuleSchema(){return this.toolchainsComponent?this.toolchainsComponent.getModuleSchema():""}getAppSchema(){return this.toolchainsComponent?this.toolchainsComponent.getAppSchema():""}getFormSchema(){return this.toolchainsComponent?this.toolchainsComponent.getFormSchema():""}getSdkJsDir(){return this.jsComponent?this.jsComponent.getBaseDir():""}getSdkEtsDir(){return this.etsComponent?this.etsComponent.getBaseDir():""}getSdkVersion(){return this.sdkVersion}getHapTobin(){return this.jsComponent.getHapToBinFilePath()}getReleaseType(){return this.toolchainsComponent?this.toolchainsComponent.getReleaseType():"Release"}getSdkNativeDir(){return this.nativeComponent.getBaseDir()}getCmakeTool(){return this.nativeComponent.getCmakeTool()}getNativeNinjaTool(){return this.nativeComponent.getNinjaTool()}getNativeToolchain(){return this.nativeComponent.getNativeToolchain()}getSdkToolchainsDir(){return this.toolchainsComponent?this.toolchainsComponent.getBaseDir():""}getRestool(){return this.toolchainsComponent?this.toolchainsComponent.getRestoolPath():""}getSysCapTool(){return this.toolchainsComponent?this.toolchainsComponent.getSysCapToolPath():""}getSysCapFileInEts(){return this.etsComponent?this.etsComponent.getSysCapFilePath():""}getSysCapFileInJs(){return this.jsComponent?this.jsComponent.getSysCapFilePath():""}getVerifySignConfigTool(){return this.toolchainsComponent?this.toolchainsComponent.getVerifySignConfigToolPath():""}getJsArkVersion(){return this.jsComponent?this.jsComponent.getArkVersion():""}getRichSchema(){return this.toolchainsComponent?this.toolchainsComponent.getRichSchema():""}getLiteSchema(){return this.toolchainsComponent?this.toolchainsComponent.getLiteSchema():""}getEtsArkVersion(){return this.etsComponent?this.etsComponent.getArkVersion():""}getArkVersion(){return""===this.getEtsArkVersion()?this.getJsArkVersion():this.getEtsArkVersion()}getPackageTool(){return this.toolchainsComponent?this.toolchainsComponent.getPackageToolPath():""}getSignDir(){return this.toolchainsComponent?this.toolchainsComponent.getSignDir():""}getJsLoader(){return this.jsComponent?this.jsComponent.getJsLoaderPath():""}getEtsLoader(){return this.etsComponent?this.etsComponent.getEtsLoaderPath():""}requireUISyntax(){return void 0!==this.jsComponent&&void 0!==this.etsComponent?this.jsComponent.requireUISyntax()||this.etsComponent.requireUISyntax():void 0!==this.etsComponent?this.etsComponent.requireUISyntax():void 0!==this.jsComponent&&this.jsComponent.requireUISyntax()}isPreviewCompileResourceIncrement(){const t=hvigor_base_1.hvigor.getExtraConfig().get(inject_const_js_1.InjectConst.PREVIEWER_COMPILE_RES_INC),o=this.sdkVersion>=9;return"true"===t&&o}findLocalComponent(t,o){const e=new sdkmanager_common_1.PathAndApiVersion(t,this.sdkVersion);let n=(0,sdk_util_js_1.findComponentByPathAndApi)(e,o);if(!n){const t=(0,sdk_util_js_1.getNDownload)([e],this.getSdkHandler());n=(0,sdk_util_js_1.findComponentByPathAndApi)(e,t),this.initComponent(n)}const s=t===sdkmanager_common_1.ComponentPath.ETS?"ArkTS":t;return void 0===n&&this.LOGGER._buildError(`the ${s} sdk of API${this.sdkVersion} cannot be found, Please download first.`)._solution("Check the sdk.dir or go to File > Setting > OpenHarmony SDK to download it. Please Open SDK Manager.")._file(this.sdkDir)._printErrorAndExit(),n}initComponent(t){switch(t.getPath()){case sdkmanager_common_1.ComponentPath.JS:this.jsComponent=new sdk_js_component_js_1.SdkJsComponent(t);break;case sdkmanager_common_1.ComponentPath.ETS:this.etsComponent=new sdk_ets_component_js_1.SdkEtsComponent(t);break;case sdkmanager_common_1.ComponentPath.TOOLCHAINS:this.toolchainsComponent=new sdk_toolchains_component_js_1.SdkToolchainsComponent(t);break;case sdkmanager_common_1.ComponentPath.NATIVE:this.nativeComponent=new sdk_native_component_js_1.SdkNativeComponent(t)}}}exports.CommonSdkInfo=CommonSdkInfo;